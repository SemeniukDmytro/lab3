<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OpenID Connect Frontend</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 2rem;
    }

    button {
      padding: 0.5rem 1rem;
      margin: 0.5rem 0;
      cursor: pointer;
    }

    .error {
      color: red;
    }

    pre {
      background: #f5f5f5;
      padding: 0.5rem;
    }
  </style>
</head>
<body>
<h1>🔐 OpenID Connect Frontend</h1>

<div>
  <button onclick="login()">Login</button>
  <button onclick="fetchUserInfo()">Fetch User Info</button>
  <button onclick="logout()">Logout</button>
</div>

<div id="status" style="margin-top: 1rem;">
  <p>Click "Fetch User Info" to check authentication status.</p>
</div>

<script>
  function fetchUserInfo() {
    fetch('https://localhost:8080/user/info', {
      credentials: 'include',
    })
            .then(response => {
              if (!response.ok) {
                throw new Error('User not authenticated');
              }
              return response.json();
            })
            .then(data => {
              document.getElementById('status').innerHTML = `
                        <p>✅ Logged in as <strong>${data.username}</strong></p>
                        <pre>User ID: ${data.userId}</pre>
                    `;
            })
            .catch(error => {
              document.getElementById('status').innerHTML = `
                        <p>❌ Not logged in</p>
                        <p class="error">Error: ${error.message}</p>
                    `;
            });
  }

  function login() {
    window.location.href = 'https://localhost:8080/auth/login';
  }

  function logout() {
    document.cookie = 'access_token=; path=/; max-age=0';
    document.getElementById('status').innerHTML = '<p>Logged out. Click "Fetch User Info" to check again.</p>';
  }
</script>
</body>
</html>
